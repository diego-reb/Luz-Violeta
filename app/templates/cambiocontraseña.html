<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cambiar Contrase√±a - Luz Violeta</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/accesibilidad.css')}}">
    <script src="{{ url_for('static', filename='JS/accesibilidad.js')}}"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f7f1ff; /* Un lila muy claro */
            position: relative;
            overflow-x: hidden;
        }

        /* Card hover effect */
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        /* Floating decorative elements */
        .floating-element {
            animation: float 15s ease-in-out infinite;
            pointer-events: none; /* Esto permite hacer clic en elementos debajo de ellos */
            z-index: -1; /* Asegura que est√©n detr√°s de todo el contenido principal */
        }
        
        .floating-element-2 {
            animation: float-alt 18s ease-in-out infinite;
            pointer-events: none; /* Esto permite hacer clic en elementos debajo de ellos */
            z-index: -1; /* Asegura que est√©n detr√°s de todo el contenido principal */
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.6; }
            25% { transform: translateY(-20px) translateX(15px) rotate(8deg); opacity: 0.8; }
            50% { transform: translateY(-40px) translateX(-15px) rotate(-8deg); opacity: 0.6; }
            75% { transform: translateY(-20px) translateX(15px) rotate(8deg); opacity: 0.8; }
        }

        @keyframes float-alt {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0.5; }
            30% { transform: translateY(15px) translateX(-20px) rotate(-10deg); opacity: 0.7; }
            60% { transform: translateY(30px) translateX(20px) rotate(10deg); opacity: 0.5; }
        }

        /* Estilos para indicadores de fortaleza de contrase√±a */
        .password-strength {
            height: 4px;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .strength-weak {
            background-color: #ef4444;
            width: 25%;
        }

        .strength-medium {
            background-color: #f59e0b;
            width: 50%;
        }

        .strength-strong {
            background-color: #10b981;
            width: 75%;
        }

        .strength-very-strong {
            background-color: #059669;
            width: 100%;
        }
    </style>
</head>
<body class="text-gray-800 high-contrast">
    <div id="reading-guide" class="reading-guide-mask"></div>

    <header class="bg-white shadow-md rounded-b-2xl px-4 py-4 flex items-center justify-between relative z-10">
        <a href="inicio.html" class="flex items-center space-x-2">
            <img src="https://placehold.co/60x60/a78bfa/ffffff?text=LV" alt="Logo Luz Violeta" class="rounded-xl shadow-lg">
            <span class="text-3xl font-extrabold text-purple-700 hidden md:block">Luz Violeta</span>
        </a>

        <nav class="flex space-x-2 sm:space-x-4">
            <a href="inicio.html#quienes-somos" class="bg-purple-100 hover:bg-purple-200 text-purple-800 font-semibold py-2 px-3 sm:px-5 rounded-full transition-all duration-300 shadow-md text-sm sm:text-base transform hover:scale-105">
                Qui√©nes somos
            </a>
            <a href="albergues.html" class="bg-purple-100 hover:bg-purple-200 text-purple-800 font-semibold py-2 px-3 sm:px-5 rounded-full transition-all duration-300 shadow-md text-sm sm:text-base transform hover:scale-105">
                Albergues
            </a>
            <a href="apoyo-legal.html" class="bg-purple-100 hover:bg-purple-200 text-purple-800 font-semibold py-2 px-3 sm:px-5 rounded-full transition-all duration-300 shadow-md text-sm sm:text-base transform hover:scale-105">
                Apoyo legal
            </a>
            <a href="apoyo-psicologico.html" class="bg-purple-100 hover:bg-purple-200 text-purple-800 font-semibold py-2 px-3 sm:px-5 rounded-full transition-all duration-300 shadow-md text-sm sm:text-base transform hover:scale-105">
                Apoyo psicol√≥gico
            </a>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8 my-8">
        <div class="max-w-md mx-auto bg-white rounded-2xl shadow-xl overflow-hidden card-hover transition-all duration-300">
            <div class="bg-gradient-to-r from-purple-600 to-purple-800 p-6 text-white text-center">
                <h1 class="text-3xl font-bold">Cambiar Contrase√±a</h1>
                <p class="mt-2 opacity-90">Actualiza tu contrase√±a para mantener tu cuenta segura</p>
            </div>
            
            <div class="p-6 md:p-8">
                <form id="password-form" class="space-y-6">
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo electr√≥nico</label>
                        <input type="email" id="email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300" placeholder="tu.correo@ejemplo.com" required>
                    </div>
                    
                    <div>
                        <label for="current-password" class="block text-sm font-medium text-gray-700 mb-1">Contrase√±a actual</label>
                        <div class="relative">
                            <input type="password" id="current-password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300 pr-10" required>
                            <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('current-password')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label for="new-password" class="block text-sm font-medium text-gray-700 mb-1">Nueva contrase√±a</label>
                        <div class="relative">
                            <input type="password" id="new-password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300 pr-10" required onkeyup="checkPasswordStrength()">
                            <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('new-password')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                            </button>
                        </div>
                        <div id="password-strength" class="mt-2">
                            <div class="flex justify-between text-xs text-gray-500 mb-1">
                                <span>Fortaleza de la contrase√±a:</span>
                                <span id="strength-text">-</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div id="strength-bar" class="password-strength"></div>
                            </div>
                        </div>
                        <ul id="password-requirements" class="mt-2 text-xs text-gray-500 space-y-1">
                            <li id="req-length" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                Al menos 8 caracteres
                            </li>
                            <li id="req-uppercase" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                Al menos una letra may√∫scula
                            </li>
                            <li id="req-lowercase" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                Al menos una letra min√∫scula
                            </li>
                            <li id="req-number" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                Al menos un n√∫mero
                            </li>
                            <li id="req-special" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                                Al menos un car√°cter especial (!@#$%^&*)
                            </li>
                        </ul>
                    </div>
                    
                    <div>
                        <label for="confirm-password" class="block text-sm font-medium text-gray-700 mb-1">Confirmar nueva contrase√±a</label>
                        <div class="relative">
                            <input type="password" id="confirm-password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300 pr-10" required onkeyup="checkPasswordMatch()">
                            <button type="button" class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('confirm-password')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                            </button>
                        </div>
                        <div id="password-match" class="mt-1 text-xs hidden">
                            <span id="match-text" class="flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                </svg>
                                Las contrase√±as coinciden
                            </span>
                        </div>
                    </div>
                    
                    <div class="pt-4 flex flex-col sm:flex-row gap-4 justify-end">
                        <button type="button" id="cancel-button" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105">
                            Cancelar
                        </button>
                        <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-md">
                            Cambiar contrase√±a
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <footer class="bg-purple-900 text-white text-center py-6 mt-12 shadow-inner rounded-t-2xl">
        <p>¬© 2024 Luz Violeta. Juntas somos invencibles.</p>
        <p class="text-sm mt-1">Todos los derechos reservados.</p>
    </footer>

    <span class="floating-element absolute top-[10%] left-[20%] text-purple-300 text-7xl">‚ú®</span>
    <span class="floating-element-2 absolute top-[60%] left-[70%] text-pink-300 text-6xl" style="animation-delay: 2s;">üíñ</span>
    <span class="floating-element absolute top-[80%] left-[30%] text-purple-400 text-5xl" style="animation-delay: 4s;">‚ú®</span>
    <span class="floating-element-2 absolute top-[40%] left-[5%] text-pink-400 text-8xl" style="animation-delay: 6s;">üå∏</span>
    <span class="floating-element absolute top-[25%] left-[85%] text-purple-300 text-5xl" style="animation-delay: 3s;">ü¶ã</span>
    <span class="floating-element-2 absolute top-[75%] left-[15%] text-pink-300 text-4xl" style="animation-delay: 5s;">‚ú®</span>
    <span class="floating-element absolute top-[50%] left-[50%] text-purple-400 text-6xl" style="animation-delay: 7s;">üíñ</span>
    <span class="floating-element-2 absolute top-[90%] left-[60%] text-pink-400 text-7xl" style="animation-delay: 8s;">üå∏</span>
    <span class="floating-element absolute top-[35%] left-[65%] text-purple-300 text-4xl" style="animation-delay: 9s;">ü¶ã</span>

    <script>
        // Funci√≥n para mostrar/ocultar contrase√±a
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
            } else {
                input.type = 'password';
            }
        }

        // Funci√≥n para verificar la fortaleza de la contrase√±a
        function checkPasswordStrength() {
            const password = document.getElementById('new-password').value;
            const strengthBar = document.getElementById('strength-bar');
            const strengthText = document.getElementById('strength-text');
            const requirements = {
                length: document.getElementById('req-length'),
                uppercase: document.getElementById('req-uppercase'),
                lowercase: document.getElementById('req-lowercase'),
                number: document.getElementById('req-number'),
                special: document.getElementById('req-special')
            };

            let strength = 0;
            let totalRequirements = 0;
            let metRequirements = 0;

            // Verificar longitud
            if (password.length >= 8) {
                strength += 20;
                metRequirements++;
                requirements.length.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Al menos 8 caracteres';
            } else {
                requirements.length.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Al menos 8 caracteres';
            }
            totalRequirements++;

            // Verificar may√∫sculas
            if (/[A-Z]/.test(password)) {
                strength += 20;
                metRequirements++;
                requirements.uppercase.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Al menos una letra may√∫scula';
            } else {
                requirements.uppercase.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Al menos una letra may√∫scula';
            }
            totalRequirements++;

            // Verificar min√∫sculas
            if (/[a-z]/.test(password)) {
                strength += 20;
                metRequirements++;
                requirements.lowercase.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Al menos una letra min√∫scula';
            } else {
                requirements.lowercase.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Al menos una letra min√∫scula';
            }
            totalRequirements++;

            // Verificar n√∫meros
            if (/[0-9]/.test(password)) {
                strength += 20;
                metRequirements++;
                requirements.number.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Al menos un n√∫mero';
            } else {
                requirements.number.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Al menos un n√∫mero';
            }
            totalRequirements++;

            // Verificar caracteres especiales
            if (/[!@#$%^&*]/.test(password)) {
                strength += 20;
                metRequirements++;
                requirements.special.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Al menos un car√°cter especial (!@#$%^&*)';
            } else {
                requirements.special.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Al menos un car√°cter especial (!@#$%^&*)';
            }
            totalRequirements++;

            // Actualizar barra y texto de fortaleza
            strengthBar.className = 'password-strength';
            
            if (password.length === 0) {
                strengthBar.style.width = '0%';
                strengthText.textContent = '-';
            } else if (strength <= 20) {
                strengthBar.classList.add('strength-weak');
                strengthText.textContent = 'D√©bil';
                strengthText.className = 'text-red-600';
            } else if (strength <= 40) {
                strengthBar.classList.add('strength-medium');
                strengthText.textContent = 'Media';
                strengthText.className = 'text-yellow-600';
            } else if (strength <= 60) {
                strengthBar.classList.add('strength-strong');
                strengthText.textContent = 'Fuerte';
                strengthText.className = 'text-green-600';
            } else {
                strengthBar.classList.add('strength-very-strong');
                strengthText.textContent = 'Muy fuerte';
                strengthText.className = 'text-green-700';
            }
        }

        // Funci√≥n para verificar si las contrase√±as coinciden
        function checkPasswordMatch() {
            const password = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            const matchDiv = document.getElementById('password-match');
            const matchText = document.getElementById('match-text');

            if (confirmPassword.length === 0) {
                matchDiv.classList.add('hidden');
                return;
            }

            if (password === confirmPassword) {
                matchDiv.classList.remove('hidden');
                matchText.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Las contrase√±as coinciden';
                matchText.className = 'flex items-center text-green-600';
            } else {
                matchDiv.classList.remove('hidden');
                matchText.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>Las contrase√±as no coinciden';
                matchText.className = 'flex items-center text-red-600';
            }
        }

        // Manejo del formulario
        document.getElementById('password-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            // Validaciones b√°sicas
            if (newPassword !== confirmPassword) {
                alert('Las contrase√±as no coinciden. Por favor, verifica que hayas escrito la misma contrase√±a en ambos campos.');
                return;
            }
            
            if (newPassword.length < 8) {
                alert('La nueva contrase√±a debe tener al menos 8 caracteres.');
                return;
            }
            
            // Aqu√≠ ir√≠a la l√≥gica para enviar los datos al servidor
            // Por ahora, simulamos el env√≠o exitoso
            
            // Mostrar mensaje de √©xito
            showNotification('Contrase√±a cambiada exitosamente', 'success');
            
            // Limpiar formulario
            document.getElementById('password-form').reset();
            document.getElementById('password-match').classList.add('hidden');
            document.getElementById('strength-bar').style.width = '0%';
            document.getElementById('strength-text').textContent = '-';
            
            // Resetear indicadores de requisitos
            const requirements = document.querySelectorAll('#password-requirements li');
            requirements.forEach(req => {
                const icon = req.querySelector('svg');
                icon.classList.remove('text-green-500');
                icon.classList.add('text-red-500');
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />';
            });
        });

        // Bot√≥n cancelar
        document.getElementById('cancel-button').addEventListener('click', function() {
            if(confirm('¬øEst√°s segura de que quieres cancelar? Los cambios no guardados se perder√°n.')) {
                window.location.href = 'inicio.html';
            }
        });

        // Funci√≥n para mostrar notificaciones
        function showNotification(message, type) {
            // Crear elemento de notificaci√≥n
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transform transition-transform duration-300 ${
                type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
            }`;
            notification.textContent = message;
            
            // Agregar al documento
            document.body.appendChild(notification);
            
            // Remover despu√©s de 3 segundos
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>